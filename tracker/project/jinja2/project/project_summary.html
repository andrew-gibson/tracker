
<div id="project{{project.id}}">
</div>

<script type="module">
import  {append_edit_fk, append_edit_attr,dispose_functions } from "d3-ui";
(()=>{
    const observable_data = mobx.makeAutoObservable(
      {{dumps(project)|safe}}
    );
    const add_title_links  = {{'true' if add_title_links else 'false'}};
    const root = d3.select("#project{{project.id}}")
        .selectAll("div")
        .data([observable_data])
        .join("div")
        .classed("col-4 border pe-0" ,true)
        .call(function(selection){
            if (add_title_links){
                selection
                    .append("button")
                    .classed("btn btn-link pb-1 ps-0",true)
                    .attrs({
                        "hx-replace-url":"true",
                        "hx-swap":"outerHTML",
                        "hx-target" : "#main-content",
                        "hx-get" : "{{url('core:rest', kwargs={'pk' :project.id, 'm' : 'project.Project'})}}",
                    })
                    .setup_htmx()
                    .html(d=>d.name)
                    .select_parent()
                    .append("div")
                    .classed("text-dark text-opacity-75 lh-1 mb-2",true)
                    .styles({
                        "font-size" : "0.8em",
                    })
                    .html(d=>d.text)
            } else {
                append_edit_attr(selection, observable_data, "name", "Name");
                append_edit_attr(selection, observable_data, "text","Description");
            }
        })
        .call(function(selection){
            append_edit_fk(selection, observable_data,"streams", "Streams");
            append_edit_fk(selection, observable_data,"point_of_contact", "Contact");
            append_edit_fk(selection, observable_data,"tags", "Tags");
            append_edit_fk(selection, observable_data,"teams", "Teams");
        })

})()
</script>

